<% if Rails.application.secrets.google_analytics_token.present? %>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=<%= Rails.application.secrets.google_analytics_token %>"></script>
  <%# TODO: javascript_tag, nonce: true do %>
  <%= javascript_tag do %>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    document.addEventListener('turbolinks:load', function() {
      return gtag('config', '<%= Rails.application.secrets.google_analytics_token %>', {
        'page_path': window.location.pathname
      });
    });
  <% end %>
  <!-- End Google Analytics -->
<% end %>
